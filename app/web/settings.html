<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhoomi TechZone - User Settings</title>
    <style>
        /* CSS Reset and Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #3b82f6;
            --secondary: #10b981;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --info: #3b82f6;
            
            --bg-light: #f9fafb;
            --bg-dark: #111827;
            --bg-card: #ffffff;
            
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --text-light: #f9fafb;
            --text-muted: #9ca3af;
            
            --border-color: #e5e7eb;
            --border-radius: 0.5rem;
        }
        
        body {
            background-color: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        /* Layout Styles */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 250px;
            background-color: white;
            border-right: 1px solid var(--border-color);
            position: fixed;
            height: 100vh;
            z-index: 100;
            transition: all 0.3s ease;
        }
        
        .main-content {
            flex: 1;
            margin-left: 250px;
            transition: all 0.3s ease;
        }
        
        /* Header & Navigation Styles */
        .sidebar-header {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        .company-logo {
            display: flex;
            align-items: center;
        }
        
        .company-name {
            font-weight: 600;
            font-size: 1.25rem;
            margin-left: 0.75rem;
        }
        
        .nav-list {
            list-style: none;
            padding: 1rem 0;
        }
        
        .nav-item {
            padding: 0.25rem 1.5rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s ease;
        }
        
        .nav-link:hover {
            background-color: var(--bg-light);
        }
        
        .nav-link.active {
            background-color: rgba(37, 99, 235, 0.1);
            color: var(--primary);
            font-weight: 500;
        }
        
        .nav-link i {
            margin-right: 0.75rem;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        
        .top-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: white;
            border-bottom: 1px solid var(--border-color);
        }
        
        .menu-toggle {
            background: none;
            border: none;
            cursor: pointer;
            display: none;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            margin-right: 0.5rem;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 200px;
            z-index: 100;
            display: none;
        }
        
        .user-dropdown.active {
            display: block;
        }
        
        .dropdown-item {
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .dropdown-item:hover {
            background-color: var(--bg-light);
        }
        
        .dropdown-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 0.5rem 0;
        }
        
        .page-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        /* Main Content Styles */
        .settings-main {
            padding: 2rem;
        }
        
        .welcome-title {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .welcome-subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* Settings Tabs */
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 2rem;
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 1rem 1.5rem;
            font-weight: 500;
            color: var(--text-secondary);
            border: none;
            background: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .tab-btn:hover {
            color: var(--primary);
        }
        
        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        /* Settings Content */
        .settings-content {
            display: none;
        }
        
        .settings-content.active {
            display: block;
        }
        
        .settings-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .settings-section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
            color: var(--text-primary);
        }
        
        .form-row {
            margin-bottom: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .form-control {
            display: block;
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            line-height: 1.5;
            color: var(--text-primary);
            background-color: white;
            background-clip: padding-box;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            box-sizing: border-box;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-control:disabled {
            background-color: var(--bg-light);
            opacity: 0.65;
            cursor: not-allowed;
        }
        
        .help-text {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        .text-muted {
            color: var(--text-muted);
        }
        
        .text-danger {
            color: var(--danger);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.625rem 1.25rem;
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1.5;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            border: 1px solid transparent;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }
        
        .btn-primary {
            color: white;
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
        }
        
        .btn-outline {
            color: var(--text-primary);
            background-color: transparent;
            border-color: var(--border-color);
        }
        
        .btn-outline:hover {
            background-color: var(--bg-light);
        }
        
        .btn-danger {
            color: white;
            background-color: var(--danger);
            border-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
            border-color: #dc2626;
        }
        
        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }
        
        .btn:disabled {
            opacity: 0.65;
            pointer-events: none;
        }
        
        .hidden {
            display: none !important;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            align-items: start;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1.5rem;
            align-items: start;
        }
        
        @media (max-width: 992px) {
            .grid-3 {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        
        .avatar-section {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 500;
            color: white;
            overflow: hidden;
            position: relative;
        }
        
        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .avatar-actions {
            margin-left: 1.5rem;
        }
        
        /* Alert Styles */
        .alert {
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: var(--border-radius);
        }
        
        .alert-success {
            color: #0f5132;
            background-color: #d1e7dd;
            border-color: #badbcc;
        }
        
        .alert-danger {
            color: #842029;
            background-color: #f8d7da;
            border-color: #f5c2c7;
        }
        
        .alert-warning {
            color: #664d03;
            background-color: #fff3cd;
            border-color: #ffecb5;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 9999;
            display: none;
        }
        
        .toast.show {
            display: block;
            animation: toast-in-out 3s forwards;
        }
        
        @keyframes toast-in-out {
            0% { transform: translateY(100%); opacity: 0; }
            15% { transform: translateY(0); opacity: 1; }
            85% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(100%); opacity: 0; }
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(59, 130, 246, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modal-slide-in 0.3s ease-out;
        }
        
        @keyframes modal-slide-in {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background-color: var(--bg-light);
            color: var(--text-primary);
        }
        
        .modal-body {
            padding: 1.5rem 2rem;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding: 1rem 2rem 1.5rem 2rem;
            border-top: 1px solid var(--border-color);
        }
        
        .form-section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Ensure form inputs don't overflow */
        .modal .form-control {
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .modal .grid-2,
        .modal .grid-3 {
            width: 100%;
            box-sizing: border-box;
        }
        
        .modal .form-group {
            min-width: 0;
            overflow: hidden;
        }
        
        /* Responsive modal */
        @media (max-width: 768px) {
            .modal {
                padding: 0.5rem;
            }
            
            .modal-content {
                max-width: none;
                width: 100%;
                margin: 0;
            }
            
            .modal-header,
            .modal-body,
            .modal-footer {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body>
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="company-logo">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <path d="M16 4L28 16L16 28L4 16L16 4Z" fill="#2563eb" />
                        <path d="M16 10L22 16L16 22L10 16L16 10Z" fill="#1d4ed8" />
                    </svg>
                    <div class="company-name">Bhoomi TechZone</div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="/static/dashboard.html" class="nav-link">
                            <i>📊</i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item employee-nav">
                        <a href="/app/attendance" class="nav-link">
                            <i>🕒</i>
                            Attendance
                        </a>
                    </li>
                    <li class="nav-item manager-nav">
                        <a href="/static/projects.html" class="nav-link">
                            <i>📁</i>
                            Projects
                        </a>
                    </li>
                    <li class="nav-item employee-nav">
                        <a href="/static/daily-reports.html" class="nav-link">
                            <i>📝</i>
                            Daily Reports
                        </a>
                    </li>
                    <li class="nav-item manager-nav">
                        <a href="/static/team.html" class="nav-link">
                            <i>👥</i>
                            Team
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/static/performance-reviews.html" class="nav-link">
                            <i>⭐</i>
                            Performance
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/app/settings" class="nav-link">
                            <i>📅</i>
                            Leave Requests
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/static/settings.html" class="nav-link active">
                            <i>⚙️</i>
                            Settings
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div id="sidebar-username" style="font-weight: 500;">soheru</div>
                    <div id="sidebar-position" style="color: var(--text-secondary); font-size: 0.875rem;">Employee</div>
                </div>
            </div>
        </aside>
        
        <div class="main-content">
            <header class="top-header">
                <div class="left-section">
                    <button class="menu-toggle" id="menuToggle">
                        <span>☰</span>
                    </button>
                    <h1 class="page-title">Settings</h1>
                </div>
                
                <div class="user-menu" id="userMenu">
                    <div class="user-avatar" id="userInitials">S</div>
                    <span id="userTimeDisplay">08:26 - soheru</span>
                    
                    <div class="user-dropdown" id="userDropdown">
                        <a href="/static/profile.html" class="dropdown-item">
                            <i>👤</i> Your Profile
                        </a>
                        
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" id="logoutBtn">
                            <i>🚪</i> Log Out
                        </a>
                    </div>
                </div>
            </header>
            
            <main class="settings-main">
                <h1 class="welcome-title">Settings</h1>
                <p class="welcome-subtitle">Manage your account settings and preferences</p>
                
                <div id="alertContainer"></div>
                
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="profile">Profile</button>
                    <button class="tab-btn" data-tab="account">Account</button>
                    <button class="tab-btn" data-tab="preferences">Preferences</button>
                    <button class="tab-btn" data-tab="notifications">Notifications</button>
                    <button class="tab-btn manager-only" data-tab="employees">Employee Management</button>
                    <button class="tab-btn director-only" data-tab="system">System Settings</button>
                </div>
                
                <div class="settings-content active" id="profile-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">Personal Information</h2>
                        
                        <div class="avatar-section">
                            <div class="avatar-preview" id="avatarPreview">
                                <div id="initialsDisplay">S</div>
                                <img id="avatarImage" src="" alt="Profile Picture" style="display: none;">
                            </div>
                            <div class="avatar-actions">
                                <button class="btn btn-outline" id="uploadAvatarBtn">Upload Photo</button>
                                <input type="file" id="avatarInput" style="display: none;" accept="image/*">
                                <div class="help-text">Recommended: Square image, at least 200x200 pixels.</div>
                            </div>
                        </div>
                        
                        <form id="profileForm">
                            <!-- Name Fields -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="firstName" class="form-label">First Name *</label>
                                    <input type="text" id="firstName" name="first_name" class="form-control" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="lastName" class="form-label">Last Name *</label>
                                    <input type="text" id="lastName" name="last_name" class="form-control" required>
                                </div>
                            </div>
                            
                            <!-- Display Name and Email -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="displayName" class="form-label">Display Name</label>
                                    <input type="text" id="displayName" name="display_name" class="form-control">
                                    <div class="help-text">This name will be displayed to other users.</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="email" class="form-label">Email Address *</label>
                                    <input type="email" id="email" name="email" class="form-control" required>
                                </div>
                            </div>
                            
                            <!-- Phone and Bio -->
                            <div class="form-group">
                                <label for="phone" class="form-label">Phone Number</label>
                                <input type="tel" id="phone" name="phone" class="form-control" placeholder="+1 (555) 123-4567">
                            </div>
                            
                            <div class="form-group">
                                <label for="bio" class="form-label">Bio / About Me</label>
                                <textarea id="bio" name="bio" rows="3" class="form-control" maxlength="200" placeholder="Tell us a bit about yourself..."></textarea>
                                <div class="help-text">Brief description about yourself (max 200 characters).</div>
                            </div>
                            
                            <!-- Personal Details -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="birthday" class="form-label">Date of Birth</label>
                                    <input type="date" id="birthday" name="birthday" class="form-control">
                                </div>
                                
                                <div class="form-group">
                                    <label for="gender" class="form-label">Gender</label>
                                    <select id="gender" name="gender" class="form-control">
                                        <option value="">Select Gender</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                        <option value="other">Other</option>
                                        <option value="prefer_not_to_say">Prefer not to say</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" id="saveProfileBtn" class="btn btn-primary">Save Profile Changes</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="settings-section">
                        <h2 class="settings-section-title">Address Information</h2>
                        
                        <form id="addressForm">
                            <div class="form-group">
                                <label for="address" class="form-label">Street Address</label>
                                <input type="text" id="address" name="address" class="form-control" placeholder="123 Main Street, Apt 4B">
                            </div>
                            
                            <div class="grid-3">
                                <div class="form-group">
                                    <label for="city" class="form-label">City</label>
                                    <input type="text" id="city" name="city" class="form-control" placeholder="New York">
                                </div>
                                
                                <div class="form-group">
                                    <label for="state" class="form-label">State/Province</label>
                                    <input type="text" id="state" name="state" class="form-control" placeholder="NY">
                                </div>
                                
                                <div class="form-group">
                                    <label for="zipCode" class="form-label">Zip/Postal Code</label>
                                    <input type="text" id="zipCode" name="zip_code" class="form-control" placeholder="10001">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="country" class="form-label">Country</label>
                                <select id="country" name="country" class="form-control">
                                    <option value="">Select Country</option>
                                    <option value="US">United States</option>
                                    <option value="CA">Canada</option>
                                    <option value="IN">India</option>
                                    <option value="UK">United Kingdom</option>
                                    <option value="AU">Australia</option>
                                    <option value="JP">Japan</option>
                                    <option value="DE">Germany</option>
                                    <option value="FR">France</option>
                                    <option value="BR">Brazil</option>
                                    <option value="MX">Mexico</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Address Information</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="settings-content" id="account-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">Account Information</h2>
                        
                        <form id="accountForm">
                            <!-- Basic Account Info -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="username" class="form-label">Username</label>
                                    <input type="text" id="username" name="username" class="form-control" disabled>
                                    <div class="help-text">Username cannot be changed.</div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Employee ID</label>
                                    <input type="text" id="employeeId" class="form-control" disabled>
                                    <div class="help-text">Auto-generated employee identifier.</div>
                                </div>
                            </div>
                            
                            <!-- Role and Department -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="role" class="form-label">Role</label>
                                    <input type="text" id="role" name="role" class="form-control non-director" disabled>
                                    <select id="roleSelect" name="role" class="form-control director-only" style="display: none;">
                                        <option value="employee">Employee</option>
                                        <option value="team_lead">Team Lead</option>
                                        <option value="manager">Manager</option>
                                        <option value="hr">HR</option>
                                        <option value="director">Director</option>
                                        <option value="admin">Admin</option>
                                    </select>
                                    <div class="help-text non-director">Role can only be changed by a director or administrator.</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="department" class="form-label">Department</label>
                                    <input type="text" id="department" name="department" class="form-control non-director" disabled>
                                    <select id="departmentSelect" name="department" class="form-control director-only" style="display: none;">
                                        <option value="">Select Department</option>
                                        <option value="Engineering">Engineering</option>
                                        <option value="Design">Design</option>
                                        <option value="Product">Product</option>
                                        <option value="Marketing">Marketing</option>
                                        <option value="Sales">Sales</option>
                                        <option value="Customer Support">Customer Support</option>
                                        <option value="HR">Human Resources</option>
                                        <option value="Finance">Finance</option>
                                        <option value="Operations">Operations</option>
                                        <option value="Administration">Administration</option>
                                    </select>
                                    <div class="help-text non-director">Department can only be changed by a director or administrator.</div>
                                </div>
                            </div>
                            
                            <!-- Position and Employment -->
                            <div class="grid-2">
                                <div class="form-group">
                                    <label for="position" class="form-label">Position Title</label>
                                    <input type="text" id="position" name="position" class="form-control">
                                    <div class="help-text">Your current job title or position.</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="employmentType" class="form-label">Employment Type</label>
                                    <input type="text" id="employmentTypeText" class="form-control non-director" disabled>
                                    <select id="employmentType" name="employment_type" class="form-control director-only" style="display: none;">
                                        <option value="full_time">Full Time</option>
                                        <option value="part_time">Part Time</option>
                                        <option value="contract">Contract</option>
                                        <option value="intern">Intern</option>
                                        <option value="temporary">Temporary</option>
                                    </select>
                                    <div class="help-text">Your employment classification.</div>
                                </div>
                            </div>
                            
                            <!-- Director Only Fields -->
                            <div class="grid-2 director-only">
                                <div class="form-group">
                                    <label for="joiningDate" class="form-label">Joining Date</label>
                                    <input type="date" id="joiningDate" name="joining_date" class="form-control">
                                    <div class="help-text">Date when employment started.</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="salary" class="form-label">Salary</label>
                                    <input type="number" id="salary" name="salary" class="form-control" step="0.01" placeholder="0.00">
                                    <div class="help-text">Annual salary amount.</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Account Information</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="settings-section">
                        <h2 class="settings-section-title">Change Password</h2>
                        
                        <form id="passwordForm">
                            <div class="form-group">
                                <label for="currentPassword" class="form-label">Current Password</label>
                                <input type="password" id="currentPassword" name="current_password" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="newPassword" class="form-label">New Password</label>
                                <input type="password" id="newPassword" name="new_password" class="form-control" required>
                                <div class="help-text">Password must be at least 8 characters and include uppercase, lowercase, number, and special character.</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="confirmPassword" class="form-label">Confirm Password</label>
                                <input type="password" id="confirmPassword" name="confirm_password" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Change Password</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="settings-content" id="preferences-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">Appearance Preferences</h2>
                        
                        <form id="appearanceForm">
                            <div class="form-group">
                                <label for="theme" class="form-label">Theme</label>
                                <select id="theme" name="theme" class="form-control">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="system">System Default</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="colorAccent" class="form-label">Color Accent</label>
                                <select id="colorAccent" name="color_accent" class="form-control">
                                    <option value="blue">Blue</option>
                                    <option value="purple">Purple</option>
                                    <option value="green">Green</option>
                                    <option value="red">Red</option>
                                    <option value="orange">Orange</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Preferences</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="settings-section">
                        <h2 class="settings-section-title">Regional Preferences</h2>
                        
                        <form id="regionalForm">
                            <div class="form-group">
                                <label for="language" class="form-label">Language</label>
                                <select id="language" name="language" class="form-control">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="hi">Hindi</option>
                                    <option value="zh">Chinese</option>
                                    <option value="ja">Japanese</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="timeZone" class="form-label">Time Zone</label>
                                <select id="timeZone" name="time_zone" class="form-control">
                                    <option value="UTC">UTC (Coordinated Universal Time)</option>
                                    <option value="America/New_York">Eastern Time (US & Canada)</option>
                                    <option value="America/Chicago">Central Time (US & Canada)</option>
                                    <option value="America/Denver">Mountain Time (US & Canada)</option>
                                    <option value="America/Los_Angeles">Pacific Time (US & Canada)</option>
                                    <option value="Europe/London">London</option>
                                    <option value="Europe/Paris">Paris</option>
                                    <option value="Asia/Tokyo">Tokyo</option>
                                    <option value="Asia/Kolkata">India</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="dateFormat" class="form-label">Date Format</label>
                                <select id="dateFormat" name="date_format" class="form-control">
                                    <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                    <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                    <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Regional Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="settings-content" id="notifications-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">Notification Settings</h2>
                        
                        <form id="notificationsForm">
                            <div class="form-group">
                                <label class="form-label">Email Notifications</label>
                                <div class="form-check">
                                    <input type="checkbox" id="emailProjectUpdates" name="email_project_updates" class="form-check-input">
                                    <label for="emailProjectUpdates" class="form-check-label">Project updates and assignments</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="emailLeaveRequests" name="email_leave_requests" class="form-check-input">
                                    <label for="emailLeaveRequests" class="form-check-label">Leave requests updates</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="emailDailyReports" name="email_daily_reports" class="form-check-input">
                                    <label for="emailDailyReports" class="form-check-label">Daily reports notifications</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Browser Notifications</label>
                                <div class="form-check">
                                    <input type="checkbox" id="browserNotifications" name="browser_notifications" class="form-check-input">
                                    <label for="browserNotifications" class="form-check-label">Browser notifications</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="soundAlerts" name="sound_alerts" class="form-check-input">
                                    <label for="soundAlerts" class="form-check-label">Sound alerts</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Notification Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="settings-content manager-only" id="employees-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">Employee Management</h2>
                        <p class="text-muted">Add and manage employee accounts. Available to team leads, managers, directors, and HR personnel.</p>
                        
                        <div class="employee-actions" style="margin-bottom: 2rem;">
                            <button class="btn btn-primary" id="addEmployeeBtn">
                                <i>👤</i> Add New Employee
                            </button>
                        </div>
                        
                        <!-- Employee List -->
                        <div class="employee-list">
                            <h3>Team Members</h3>
                            <div id="employeeListContainer">
                                <div class="loading-skeleton">
                                    <div class="skeleton-loading" style="height: 60px; margin-bottom: 1rem;"></div>
                                    <div class="skeleton-loading" style="height: 60px; margin-bottom: 1rem;"></div>
                                    <div class="skeleton-loading" style="height: 60px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-content director-only" id="system-tab">
                    <div class="settings-section">
                        <h2 class="settings-section-title">System Settings</h2>
                        <p class="text-muted">These settings are only available to administrators and directors.</p>
                        
                        <form id="systemForm">
                            <div class="form-group">
                                <label for="companyName" class="form-label">Company Name</label>
                                <input type="text" id="companyName" name="company_name" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="workingHoursStart" class="form-label">Working Hours Start</label>
                                <input type="time" id="workingHoursStart" name="working_hours_start" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="workingHoursEnd" class="form-label">Working Hours End</label>
                                <input type="time" id="workingHoursEnd" name="working_hours_end" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="workingDays" class="form-label">Working Days</label>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDayMonday" name="working_days" value="monday" class="form-check-input">
                                    <label for="workingDayMonday" class="form-check-label">Monday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDayTuesday" name="working_days" value="tuesday" class="form-check-input">
                                    <label for="workingDayTuesday" class="form-check-label">Tuesday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDayWednesday" name="working_days" value="wednesday" class="form-check-input">
                                    <label for="workingDayWednesday" class="form-check-label">Wednesday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDayThursday" name="working_days" value="thursday" class="form-check-input">
                                    <label for="workingDayThursday" class="form-check-label">Thursday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDayFriday" name="working_days" value="friday" class="form-check-input">
                                    <label for="workingDayFriday" class="form-check-label">Friday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDaySaturday" name="working_days" value="saturday" class="form-check-input">
                                    <label for="workingDaySaturday" class="form-check-label">Saturday</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="workingDaySunday" name="working_days" value="sunday" class="form-check-input">
                                    <label for="workingDaySunday" class="form-check-label">Sunday</label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="leavePolicy" class="form-label">Leave Policy</label>
                                <textarea id="leavePolicy" name="leave_policy" rows="4" class="form-control"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save System Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Add Employee Modal -->
    <div class="modal" id="addEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Employee</h2>
                <button class="modal-close" id="closeAddEmployeeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addEmployeeForm">
                    <!-- Personal Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">Personal Information</h3>
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newFirstName" class="form-label">First Name *</label>
                                <input type="text" id="newFirstName" name="first_name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="newLastName" class="form-label">Last Name *</label>
                                <input type="text" id="newLastName" name="last_name" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="newDisplayName" class="form-label">Display Name</label>
                            <input type="text" id="newDisplayName" name="display_name" class="form-control">
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newPhone" class="form-label">Phone Number</label>
                                <input type="tel" id="newPhone" name="phone" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="newBirthday" class="form-label">Date of Birth</label>
                                <input type="date" id="newBirthday" name="birthday" class="form-control">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="newGender" class="form-label">Gender</label>
                            <select id="newGender" name="gender" class="form-control">
                                <option value="">Select</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                                <option value="prefer_not_to_say">Prefer not to say</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Account Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">Account Information</h3>
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newUsername" class="form-label">Username *</label>
                                <input type="text" id="newUsername" name="username" class="form-control" required>
                                <div class="help-text">Must be unique</div>
                            </div>
                            <div class="form-group">
                                <label for="newEmail" class="form-label">Email *</label>
                                <input type="email" id="newEmail" name="email" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="newEmployeeId" class="form-label">Employee ID</label>
                            <input type="text" id="newEmployeeId" name="employee_id" class="form-control">
                            <div class="help-text">Leave empty to auto-generate</div>
                        </div>
                        
                        <div class="form-group">
                            <div class="form-check">
                                <input type="checkbox" id="generatePassword" name="generate_password" class="form-check-input" checked>
                                <label for="generatePassword" class="form-check-label">Generate random password</label>
                            </div>
                        </div>
                        
                        <div id="passwordFields" style="display: none;">
                            <div class="form-group">
                                <label for="newPassword" class="form-label">Password *</label>
                                <input type="password" id="newPassword" name="password" class="form-control">
                            </div>
                        </div>
                        
                        <div id="generatedPasswordDisplay" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Generated Password</label>
                                <div style="display: flex; gap: 0.5rem; align-items: center;">
                                    <input type="text" id="displayPassword" class="form-control" readonly>
                                    <button type="button" class="btn btn-outline" id="copyPasswordBtn">Copy</button>
                                    <button type="button" class="btn btn-outline" id="regeneratePasswordBtn">Regenerate</button>
                                </div>
                                <div class="help-text">Make sure to copy this password before saving!</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Employment Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">Employment Information</h3>
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newRole" class="form-label">Role *</label>
                                <select id="newRole" name="role" class="form-control" required>
                                    <option value="employee">Employee</option>
                                    <option value="team_lead">Team Lead</option>
                                    <option value="manager">Manager</option>
                                    <option value="hr">HR</option>
                                    <option value="director">Director</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="newDepartment" class="form-label">Department *</label>
                                <select id="newDepartment" name="department" class="form-control" required>
                                    <option value="">Select Department</option>
                                    <option value="Engineering">Engineering</option>
                                    <option value="Design">Design</option>
                                    <option value="Product">Product</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Sales">Sales</option>
                                    <option value="Customer Support">Customer Support</option>
                                    <option value="HR">Human Resources</option>
                                    <option value="Finance">Finance</option>
                                    <option value="Operations">Operations</option>
                                    <option value="Administration">Administration</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newPosition" class="form-label">Position Title</label>
                                <input type="text" id="newPosition" name="position" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="newEmploymentType" class="form-label">Employment Type</label>
                                <select id="newEmploymentType" name="employment_type" class="form-control">
                                    <option value="full_time">Full Time</option>
                                    <option value="part_time">Part Time</option>
                                    <option value="contract">Contract</option>
                                    <option value="intern">Intern</option>
                                    <option value="temporary">Temporary</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label for="newJoiningDate" class="form-label">Joining Date</label>
                                <input type="date" id="newJoiningDate" name="joining_date" class="form-control">
                            </div>
                            <div class="form-group director-only">
                                <label for="newSalary" class="form-label">Salary</label>
                                <input type="number" id="newSalary" name="salary" class="form-control" step="0.01">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Address Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">Address Information</h3>
                        <div class="form-group">
                            <label for="newAddress" class="form-label">Street Address</label>
                            <input type="text" id="newAddress" name="address" class="form-control">
                        </div>
                        
                        <div class="grid-3">
                            <div class="form-group">
                                <label for="newCity" class="form-label">City</label>
                                <input type="text" id="newCity" name="city" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="newState" class="form-label">State/Province</label>
                                <input type="text" id="newState" name="state" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="newZipCode" class="form-label">Zip/Postal Code</label>
                                <input type="text" id="newZipCode" name="zip_code" class="form-control">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="newCountry" class="form-label">Country</label>
                            <select id="newCountry" name="country" class="form-control">
                                <option value="">Select Country</option>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="IN">India</option>
                                <option value="UK">United Kingdom</option>
                                <option value="AU">Australia</option>
                                <option value="JP">Japan</option>
                                <option value="DE">Germany</option>
                                <option value="FR">France</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelAddEmployee">Cancel</button>
                <button class="btn btn-primary" id="saveEmployee">Create Employee</button>
            </div>
        </div>
    </div>
    
    <!-- Toast notification -->
    <div id="toast" class="toast"></div>
    
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Log current time
            console.log("Current Date and Time (UTC - YYYY-MM-DD HH:MM:SS formatted): 2025-06-17 08:26:35");
            console.log("Current User's Login: soheru");
            
            // Set time and username in header
            document.getElementById('userTimeDisplay').textContent = '08:26 - soheru';
            
            try {
                // Check auth token
                const token = localStorage.getItem('bhoomitechzone_token');
                if (!token) {
                    window.location.href = '/static/login.html';
                    return;
                }
                
                // Load user data
                await loadUserData();
                
                // Setup navigation and event handlers
                setupTabNavigation();
                setupFormSubmissions();
                setupAvatarUpload();
                setupEmployeeManagement();
                
                // Hide loading overlay
                document.getElementById('loadingOverlay').style.display = 'none';
            } catch (error) {
                console.error('Error initializing settings page:', error);
                showToast('Error loading user data');
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        });
        
        async function loadUserData() {
            try {
                const token = localStorage.getItem('bhoomitechzone_token');
                
                // Fetch current user data
                const response = await fetch('/users/me', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    if (response.status === 401) {
                        localStorage.removeItem('bhoomitechzone_token');
                        window.location.href = '/static/login.html';
                        return;
                    }
                    throw new Error('Failed to fetch user data');
                }
                
                const userData = await response.json();
                
                // Store user data
                window.currentUser = userData;
                
                // Update UI with user info
                updateUserInterface(userData);
                
                // Populate forms with user data
                populateForms(userData);
                
                // Handle role-specific UI elements
                handleRoleSpecificUI(userData.role);
                
                return userData;
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Failed to load user data');
                return null;
            }
        }
        
        function updateUserInterface(userData) {
            const initials = getInitials(userData.first_name, userData.last_name);
            document.getElementById('userInitials').textContent = initials;
            document.getElementById('initialsDisplay').textContent = initials;
            
            const fullName = `${userData.first_name || ''} ${userData.last_name || ''}`.trim();
            document.getElementById('sidebar-username').textContent = userData.username || 'soheru';
            document.getElementById('sidebar-position').textContent = userData.position || userData.role || 'Employee';
            
            // Update avatar if available
            if (userData.avatar_url) {
                document.getElementById('avatarImage').src = userData.avatar_url;
                document.getElementById('avatarImage').style.display = 'block';
                document.getElementById('initialsDisplay').style.display = 'none';
            }
        }
        
        function populateForms(userData) {
            console.log('Populating forms with user data:', userData);
            
            // Profile form - safely populate with null checks
            const setValue = (id, value) => {
                const element = document.getElementById(id);
                if (element) {
                    element.value = value || '';
                } else {
                    console.warn(`Element with id '${id}' not found`);
                }
            };
            
            const setSelectValue = (id, value) => {
                const element = document.getElementById(id);
                if (element && value) {
                    element.value = value;
                } else if (!element) {
                    console.warn(`Select element with id '${id}' not found`);
                }
            };
            
            // Profile form
            setValue('firstName', userData.first_name);
            setValue('lastName', userData.last_name);
            setValue('displayName', userData.display_name);
            setValue('email', userData.email);
            setValue('phone', userData.phone);
            setValue('bio', userData.bio);
            setValue('birthday', userData.birthday);
            setSelectValue('gender', userData.gender);
            
            // Address form - use flat structure from user object
            setValue('address', userData.address);
            setValue('city', userData.city);
            setValue('state', userData.state);
            setValue('zipCode', userData.zip_code);
            setSelectValue('country', userData.country);
            
            // Account form
            setValue('username', userData.username);
            setValue('employeeId', userData.employee_id || userData.id);
            setValue('position', userData.position);
            
            // Role handling
            if (userData.role) {
                setValue('role', formatRole(userData.role));
                setSelectValue('roleSelect', userData.role);
            }
            
            // Department handling
            setValue('department', userData.department);
            setSelectValue('departmentSelect', userData.department);
            
            // Employment type handling
            if (userData.employment_type) {
                setValue('employmentTypeText', formatEmploymentType(userData.employment_type));
                setSelectValue('employmentType', userData.employment_type);
            }
            
            // Director-only fields
            setValue('joiningDate', userData.joining_date);
            setValue('salary', userData.salary);
            
            // Preferences handling with safe navigation
            if (userData.preferences && typeof userData.preferences === 'object') {
                const prefs = userData.preferences;
                
                // Appearance preferences
                setSelectValue('theme', prefs.theme);
                setSelectValue('colorAccent', prefs.color_accent);
                
                // Regional preferences
                setSelectValue('language', prefs.language);
                setSelectValue('timeZone', prefs.time_zone);
                setSelectValue('dateFormat', prefs.date_format);
                
                // Notification preferences
                if (prefs.notifications && typeof prefs.notifications === 'object') {
                    const notifs = prefs.notifications;
                    
                    // Email notifications with safe checkbox handling
                    const setCheckbox = (id, value) => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.checked = Boolean(value);
                        }
                    };
                    
                    setCheckbox('emailProjectUpdates', notifs.email_project_updates);
                    setCheckbox('emailLeaveRequests', notifs.email_leave_requests);
                    setCheckbox('emailDailyReports', notifs.email_daily_reports);
                    setCheckbox('browserNotifications', notifs.browser_notifications);
                    setCheckbox('soundAlerts', notifs.sound_alerts);
                }
            }
            
            // System settings if user is director
            if (userData.role === 'director' || userData.role === 'admin') {
                loadCompanySettings();
            }
        }
        
        function handleRoleSpecificUI(role) {
            const isDirector = role === 'director' || role === 'admin';
            
            // Show/hide director-only elements
            document.querySelectorAll('.director-only').forEach(elem => {
                elem.style.display = isDirector ? '' : 'none';
            });
            
            // Toggle UI elements for non-directors
            document.querySelectorAll('.non-director').forEach(elem => {
                elem.style.display = isDirector ? 'none' : '';
            });
            
            // Special handling for role and department fields
            if (isDirector) {
                document.getElementById('role').style.display = 'none';
                document.getElementById('roleSelect').style.display = '';
                document.getElementById('department').style.display = 'none';
                document.getElementById('departmentSelect').style.display = '';
                document.getElementById('employmentTypeText').style.display = 'none';
                document.getElementById('employmentType').style.display = '';
            }
        }
        
        async function loadCompanySettings() {
            try {
                const token = localStorage.getItem('bhoomitechzone_token');
                
                // Fetch company settings
                const response = await fetch('/company/settings', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to fetch company settings');
                }
                
                const settings = await response.json();
                
                // Populate system settings form
                document.getElementById('companyName').value = settings.company_name || '';
                document.getElementById('workingHoursStart').value = settings.working_hours_start || '';
                document.getElementById('workingHoursEnd').value = settings.working_hours_end || '';
                document.getElementById('leavePolicy').value = settings.leave_policy || '';
                
                // Set working days checkboxes
                if (settings.working_days && Array.isArray(settings.working_days)) {
                    settings.working_days.forEach(day => {
                        const checkbox = document.getElementById(`workingDay${capitalizeFirstLetter(day)}`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
            } catch (error) {
                console.error('Error loading company settings:', error);
                showAlert('Failed to load company settings', 'danger');
            }
        }
        
        // Function to load and display current employees
        async function loadEmployeeList() {
            try {
                const token = localStorage.getItem('bhoomitechzone_token');
                const container = document.getElementById('employeeListContainer');
                
                if (!container) return;
                
                // Show loading
                container.innerHTML = `
                    <div class="loading-skeleton">
                        <div class="skeleton-loading" style="height: 60px; margin-bottom: 1rem;"></div>
                        <div class="skeleton-loading" style="height: 60px; margin-bottom: 1rem;"></div>
                        <div class="skeleton-loading" style="height: 60px;"></div>
                    </div>
                `;
                
                const response = await fetch('/users/', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to fetch employees');
                }
                
                const employees = await response.json();
                
                if (employees.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <p class="text-muted">No team members found.</p>
                        </div>
                    `;
                    return;
                }
                
                // Display employee list
                const employeeCards = employees.map(emp => `
                    <div class="employee-card" style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; display: flex; align-items: center; justify-content: space-between;">
                        <div class="employee-info" style="display: flex; align-items: center; gap: 1rem;">
                            <div class="employee-avatar" style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                                ${getInitials(emp.first_name, emp.last_name)}
                            </div>
                            <div class="employee-details">
                                <h4 style="margin: 0; font-size: 1rem; color: #333;">${emp.first_name} ${emp.last_name}</h4>
                                <p style="margin: 0; font-size: 0.875rem; color: #666;">${emp.employee_id || emp.id} • ${formatRole(emp.role)} ${emp.department ? '• ' + emp.department : ''}</p>
                                <p style="margin: 0; font-size: 0.875rem; color: #888;">${emp.email}</p>
                            </div>
                        </div>
                        <div class="employee-status">
                            <span class="status-badge" style="background: #e8f5e8; color: #2e7d2e; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 500;">
                                Active
                            </span>
                        </div>
                    </div>
                `).join('');
                
                container.innerHTML = employeeCards;
                
            } catch (error) {
                console.error('Error loading employee list:', error);
                const container = document.getElementById('employeeListContainer');
                if (container) {
                    container.innerHTML = `
                        <div class="error-state">
                            <p class="text-danger">Failed to load team members. Please try again.</p>
                            <button class="btn btn-outline" onclick="loadEmployeeList()">Retry</button>
                        </div>
                    `;
                }
            }
        }

        function setupTabNavigation() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and buttons
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    document.querySelectorAll('.settings-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab and its content
                    this.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    // Load employee list when employees tab is activated
                    if (tabId === 'employees') {
                        loadEmployeeList();
                    }
                });
            });
            
            // Setup user menu toggle
            const userMenu = document.getElementById('userMenu');
            const userDropdown = document.getElementById('userDropdown');
            
            userMenu.addEventListener('click', function(e) {
                e.stopPropagation();
                userDropdown.classList.toggle('active');
            });
            
            // Close user dropdown when clicking outside
            document.addEventListener('click', function() {
                userDropdown.classList.remove('active');
            });
            
            // Setup mobile menu toggle
            const menuToggle = document.getElementById('menuToggle');
            menuToggle.addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('active');
            });
            
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('bhoomitechzone_token');
                window.location.href = '/static/login.html';
            });
        }
        
        function setupFormSubmissions() {
            // Profile form submission
            document.getElementById('profileForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const profileData = {
                    first_name: formData.get('first_name'),
                    last_name: formData.get('last_name'),
                    display_name: formData.get('display_name'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    bio: formData.get('bio'),
                    birthday: formData.get('birthday'),
                    gender: formData.get('gender')
                };
                
                await updateUserProfile(profileData);
            });
            
            // Address form submission
            document.getElementById('addressForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const addressData = {
                    address: formData.get('address'),
                    city: formData.get('city'),
                    state: formData.get('state'),
                    zip_code: formData.get('zip_code'),
                    country: formData.get('country')
                };
                
                await updateUserProfile(addressData);
            });
            
            // Account form submission
            document.getElementById('accountForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const accountData = {
                    position: formData.get('position')
                };
                
                // Only directors can update these fields
                if (window.currentUser && (window.currentUser.role === 'director' || window.currentUser.role === 'admin')) {
                    accountData.role = formData.get('role');
                    accountData.department = formData.get('department');
                    accountData.employment_type = formData.get('employment_type');
                    accountData.joining_date = formData.get('joining_date');
                    accountData.salary = formData.get('salary');
                }
                
                await updateUserProfile(accountData);
            });
            
            // Password form submission
            document.getElementById('passwordForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const currentPassword = formData.get('current_password');
                const newPassword = formData.get('new_password');
                const confirmPassword = formData.get('confirm_password');
                
                // Validate passwords
                if (newPassword !== confirmPassword) {
                    showAlert('New passwords do not match', 'danger');
                    return;
                }
                
                if (newPassword.length < 8) {
                    showAlert('Password must be at least 8 characters', 'danger');
                    return;
                }
                
                // Check password strength
                const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
                if (!passwordRegex.test(newPassword)) {
                    showAlert('Password must include uppercase, lowercase, number, and special character', 'danger');
                    return;
                }
                
                await changePassword(currentPassword, newPassword);
            });
            
            // Appearance form submission
            document.getElementById('appearanceForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const appearanceData = {
                    preferences: {
                        theme: formData.get('theme'),
                        color_accent: formData.get('color_accent')
                    }
                };
                
                await updateUserPreferences(appearanceData);
            });
            
            // Regional form submission
            document.getElementById('regionalForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const regionalData = {
                    preferences: {
                        language: formData.get('language'),
                        time_zone: formData.get('time_zone'),
                        date_format: formData.get('date_format')
                    }
                };
                
                await updateUserPreferences(regionalData);
            });
            
            // Notifications form submission
            document.getElementById('notificationsForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const notificationsData = {
                    preferences: {
                        notifications: {
                            email_project_updates: formData.get('email_project_updates') === 'on',
                            email_leave_requests: formData.get('email_leave_requests') === 'on',
                            email_daily_reports: formData.get('email_daily_reports') === 'on',
                            browser_notifications: formData.get('browser_notifications') === 'on',
                            sound_alerts: formData.get('sound_alerts') === 'on'
                        }
                    }
                };
                
                await updateUserPreferences(notificationsData);
            });
            
            // System form submission (directors only)
            if (document.getElementById('systemForm')) {
                document.getElementById('systemForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    if (!(window.currentUser && (window.currentUser.role === 'director' || window.currentUser.role === 'admin'))) {
                        showAlert('Only directors can change system settings', 'danger');
                        return;
                    }
                    
                    const formData = new FormData(this);
                    
                    // Get working days as an array
                    const workingDaysCheckboxes = document.querySelectorAll('input[name="working_days"]:checked');
                    const workingDays = Array.from(workingDaysCheckboxes).map(cb => cb.value);
                    
                    const systemData = {
                        company_name: formData.get('company_name'),
                        working_hours_start: formData.get('working_hours_start'),
                        working_hours_end: formData.get('working_hours_end'),
                        working_days: workingDays,
                        leave_policy: formData.get('leave_policy')
                    };
                    
                    await updateCompanySettings(systemData);
                });
            }
        }
        
        function setupEmployeeManagement() {
            // Get modal elements
            const addEmployeeModal = document.getElementById('addEmployeeModal');
            const addEmployeeBtn = document.getElementById('addEmployeeBtn');
            const closeAddEmployeeModal = document.getElementById('closeAddEmployeeModal');
            const cancelAddEmployee = document.getElementById('cancelAddEmployee');
            const saveEmployee = document.getElementById('saveEmployee');
            const addEmployeeForm = document.getElementById('addEmployeeForm');
            
            // Ensure modal is hidden initially
            if (addEmployeeModal) {
                addEmployeeModal.classList.remove('show');
            }
            
            // Show/hide employee management tab based on role
            const currentUser = window.currentUser;
            if (currentUser && ['team_lead', 'manager', 'director', 'hr'].includes(currentUser.role)) {
                const employeeTab = document.querySelector('button[data-tab="employees"]');
                if (employeeTab) {
                    employeeTab.style.display = 'block';
                }
            }
            
            // Add Employee Modal handlers
            
            // Generate random password functionality
            const generatePasswordCheckbox = document.getElementById('generatePassword');
            const passwordFields = document.getElementById('passwordFields');
            const generatedPasswordDisplay = document.getElementById('generatedPasswordDisplay');
            const displayPassword = document.getElementById('displayPassword');
            const copyPasswordBtn = document.getElementById('copyPasswordBtn');
            const regeneratePasswordBtn = document.getElementById('regeneratePasswordBtn');
            
            if (generatePasswordCheckbox) {
                generatePasswordCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        passwordFields.style.display = 'none';
                        generatedPasswordDisplay.style.display = 'block';
                        const password = generateRandomPassword();
                        displayPassword.value = password;
                        document.getElementById('newPassword').value = password;
                    } else {
                        passwordFields.style.display = 'block';
                        generatedPasswordDisplay.style.display = 'none';
                        document.getElementById('newPassword').value = '';
                    }
                });
                
                // Initialize on page load
                if (generatePasswordCheckbox.checked) {
                    const password = generateRandomPassword();
                    displayPassword.value = password;
                    document.getElementById('newPassword').value = password;
                    passwordFields.style.display = 'none';
                    generatedPasswordDisplay.style.display = 'block';
                }
            }
            
            if (regeneratePasswordBtn) {
                regeneratePasswordBtn.addEventListener('click', function() {
                    const password = generateRandomPassword();
                    displayPassword.value = password;
                    document.getElementById('newPassword').value = password;
                });
            }
            
            if (copyPasswordBtn) {
                copyPasswordBtn.addEventListener('click', async function() {
                    try {
                        await navigator.clipboard.writeText(displayPassword.value);
                        copyPasswordBtn.textContent = 'Copied!';
                        setTimeout(() => {
                            copyPasswordBtn.textContent = 'Copy';
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy password:', err);
                        showToast('Failed to copy password');
                    }
                });
            }
            
            // Modal event handlers
            if (addEmployeeBtn) {
                addEmployeeBtn.addEventListener('click', function() {
                    console.log('Add Employee button clicked!');
                    console.log('Modal element:', addEmployeeModal);
                    addEmployeeModal.classList.add('show');
                    console.log('Modal classes after show:', addEmployeeModal.className);
                    // Clear form
                    addEmployeeForm.reset();
                    // Set default joining date to today
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('newJoiningDate').value = today;
                    
                    // Reset password generation
                    const generateCheckbox = document.getElementById('generatePassword');
                    if (generateCheckbox) {
                        generateCheckbox.checked = true;
                        generateCheckbox.dispatchEvent(new Event('change'));
                    }
                });
            } else {
                console.log('Add Employee button not found!');
            }
            
            if (closeAddEmployeeModal) {
                closeAddEmployeeModal.addEventListener('click', function() {
                    addEmployeeModal.classList.remove('show');
                });
            }
            
            if (cancelAddEmployee) {
                cancelAddEmployee.addEventListener('click', function() {
                    addEmployeeModal.classList.remove('show');
                });
            }
            
            // Close modal when clicking outside
            addEmployeeModal.addEventListener('click', function(e) {
                if (e.target === addEmployeeModal) {
                    addEmployeeModal.classList.remove('show');
                }
            });
            
            // Employee form submission
            if (addEmployeeForm) {
                addEmployeeForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    await handleCreateEmployee();
                });
            }
            
            if (saveEmployee) {
                saveEmployee.addEventListener('click', async function() {
                    await handleCreateEmployee();
                });
            }
        }
        
        function generateRandomPassword(length = 12) {
            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const special = '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            const allChars = uppercase + lowercase + numbers + special;
            let password = '';
            
            // Ensure at least one character from each category
            password += uppercase[Math.floor(Math.random() * uppercase.length)];
            password += lowercase[Math.floor(Math.random() * lowercase.length)];
            password += numbers[Math.floor(Math.random() * numbers.length)];
            password += special[Math.floor(Math.random() * special.length)];
            
            // Fill the rest randomly
            for (let i = 4; i < length; i++) {
                password += allChars[Math.floor(Math.random() * allChars.length)];
            }
            
            // Shuffle the password
            return password.split('').sort(() => Math.random() - 0.5).join('');
        }
        
        async function handleCreateEmployee() {
            try {
                const form = document.getElementById('addEmployeeForm');
                const formData = new FormData(form);
                
                // Check if using generated password
                const generatePasswordCheckbox = document.getElementById('generatePassword');
                const isGeneratingPassword = generatePasswordCheckbox && generatePasswordCheckbox.checked;
                
                // Validate required fields
                const requiredFields = ['username', 'email', 'first_name', 'last_name', 'role', 'department'];
                const missingFields = [];
                
                for (const field of requiredFields) {
                    if (!formData.get(field) || formData.get(field).trim() === '') {
                        missingFields.push(field.replace('_', ' '));
                    }
                }
                
                // Check password separately since it might be generated
                if (!isGeneratingPassword) {
                    // Only validate password field if not generating
                    const manualPassword = formData.get('password');
                    if (!manualPassword || manualPassword.trim() === '') {
                        missingFields.push('password');
                    }
                }
                
                if (missingFields.length > 0) {
                    showToast(`Please fill in required fields: ${missingFields.join(', ')}`);
                    return;
                }
                
                // Validate email format
                const email = formData.get('email');
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    showToast('Please enter a valid email address');
                    return;
                }
                
                // Get password - either from the manual field or generated field
                let password = '';
                
                if (isGeneratingPassword) {
                    // Use generated password
                    const displayPasswordField = document.getElementById('displayPassword');
                    if (displayPasswordField) {
                        password = displayPasswordField.value;
                    }
                    console.log('Using generated password:', password);
                } else {
                    // Use manually entered password
                    password = formData.get('password');
                    console.log('Using manual password:', password ? '[PROVIDED]' : '[EMPTY]');
                }
                
                // Validate password strength
                if (!password || password.length < 8) {
                    if (isGeneratingPassword) {
                        showToast('Generated password is missing. Please regenerate password.');
                    } else {
                        showToast('Password must be at least 8 characters long');
                    }
                    return;
                }
                
                // Build employee data object
                const employeeData = {
                    username: formData.get('username'),
                    email: formData.get('email'),
                    password: password,
                    first_name: formData.get('first_name'),
                    last_name: formData.get('last_name'),
                    display_name: formData.get('display_name'),
                    phone: formData.get('phone'),
                    bio: formData.get('bio'),
                    birthday: formData.get('birthday'),
                    gender: formData.get('gender'),
                    role: formData.get('role'),
                    department: formData.get('department'),
                    position: formData.get('position'),
                    employment_type: formData.get('employment_type'),
                    joining_date: formData.get('joining_date'),
                    address: formData.get('address'),
                    city: formData.get('city'),
                    state: formData.get('state'),
                    zip_code: formData.get('zip_code'),
                    country: formData.get('country')
                };
                
                console.log('Employee data being sent:', {
                    ...employeeData,
                    password: '[HIDDEN]' // Don't log actual password
                });
                
                // Only directors can set salary
                if (window.currentUser && window.currentUser.role === 'director') {
                    const salary = formData.get('salary');
                    if (salary) {
                        employeeData.salary = parseFloat(salary);
                    }
                }
                
                // Remove empty values
                Object.keys(employeeData).forEach(key => {
                    if (employeeData[key] === '' || employeeData[key] === null) {
                        delete employeeData[key];
                    }
                });
                
                // Show loading state
                const saveButton = document.getElementById('saveEmployee');
                const originalText = saveButton.textContent;
                saveButton.textContent = 'Creating...';
                saveButton.disabled = true;
                
                // Create employee via API
                const result = await createEmployee(employeeData);
                
                if (result.success) {
                    showToast('Employee created successfully!');
                    const modal = document.getElementById('addEmployeeModal');
                    if (modal) {
                        modal.classList.remove('show');
                    }
                    form.reset();
                    
                    // Refresh employee list
                    await loadEmployeeList();
                } else {
                    showToast(result.error || 'Failed to create employee');
                }
                
            } catch (error) {
                console.error('Error creating employee:', error);
                showToast('Error creating employee');
            } finally {
                // Restore button state
                const saveButton = document.getElementById('saveEmployee');
                saveButton.textContent = 'Create Employee';
                saveButton.disabled = false;
            }
        }
        
        async function createEmployee(employeeData) {
            try {
                const token = localStorage.getItem('bhoomitechzone_token');
                
                const response = await fetch('/users/employees', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(employeeData)
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    return {
                        success: false,
                        error: errorData.detail || 'Failed to create employee'
                    };
                }
                
                const result = await response.json();
                return {
                    success: true,
                    data: result
                };
                
            } catch (error) {
                console.error('API error creating employee:', error);
                return {
                    success: false,
                    error: 'Network error creating employee'
                };
            }
        }
        
        function setupAvatarUpload() {
            // Avatar upload functionality
            const avatarInput = document.getElementById('avatarInput');
            if (!avatarInput) return;
            
            avatarInput.addEventListener('change', async function(e) {
                if (!e.target.files.length) return;
                
                const file = e.target.files[0];
                
                // Validate file type
                if (!file.type.startsWith('image/')) {
                    showAlert('Please select an image file.', 'danger');
                    return;
                }
                
                // Validate file size (limit to 5MB)
                const maxSize = 5 * 1024 * 1024; // 5MB in bytes
                if (file.size > maxSize) {
                    showAlert('Image size should be less than 5MB.', 'danger');
                    return;
                }
                
                try {
                    // Create FormData object to send file
                    const formData = new FormData();
                    formData.append('avatar', file);
                    
                    const token = localStorage.getItem('bhoomitechzone_token');
                    
                    // Upload the avatar
                    const response = await fetch('/users/me/avatar', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to upload avatar');
                    }
                    
                    const data = await response.json();
                    
                    // Update UI with new avatar
                    if (data.avatar_url) {
                        document.getElementById('avatarImage').src = data.avatar_url;
                        document.getElementById('avatarImage').style.display = 'block';
                        document.getElementById('initialsDisplay').style.display = 'none';
                        
                        // Update local user data
                        if (window.currentUser) {
                            window.currentUser.avatar_url = data.avatar_url;
                        }
                    }
                    
                    showToast('Avatar uploaded successfully');
                } catch (error) {
                    console.error('Error uploading avatar:', error);
                    showToast('Error uploading avatar');
                    showAlert('Failed to upload avatar. Please try again.', 'danger');
                }
            });
        }
        
        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alertContainer');
            
            const alertEl = document.createElement('div');
            alertEl.className = `alert alert-${type}`;
            alertEl.textContent = message;
            
            // Add close button
            const closeBtn = document.createElement('button');
            closeBtn.type = 'button';
            closeBtn.innerHTML = '&times;';
            closeBtn.style.float = 'right';
            closeBtn.style.border = 'none';
            closeBtn.style.background = 'none';
            closeBtn.style.fontSize = '1.25rem';
            closeBtn.style.fontWeight = 'bold';
            closeBtn.style.cursor = 'pointer';
            closeBtn.style.lineHeight = '1';
            
            closeBtn.addEventListener('click', function() {
                alertContainer.removeChild(alertEl);
            });
            
            alertEl.appendChild(closeBtn);
            alertContainer.appendChild(alertEl);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (alertContainer.contains(alertEl)) {
                    alertContainer.removeChild(alertEl);
                }
            }, 5000);
        }
        
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Utility functions
        
        function getInitials(firstName, lastName) {
            let initials = '';
            
            if (firstName) {
                initials += firstName.charAt(0).toUpperCase();
            }
            
            if (lastName) {
                initials += lastName.charAt(0).toUpperCase();
            }
            
            return initials || 'S';  // Default to 'S' for soheru
        }
        
        function formatRole(role) {
            if (!role) return '';
            
            // Format like "team_lead" to "Team Lead"
            return role.split('_')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }
        
        function formatEmploymentType(type) {
            if (!type) return '';
            
            // Format like "full_time" to "Full Time"
            return type.split('_')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }
        
        function capitalizeFirstLetter(string) {
            if (!string) return '';
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
        
        // Update the displayed time
        document.addEventListener('DOMContentLoaded', function() {
            const currentTimestamp = "2025-06-17 09:24:54";  // Updated timestamp
            document.getElementById('userTimeDisplay').textContent = `09:24 - soheru`;
        });
    </script>
</body>
</html>